---
description: 要件定義をベースに技術選定を行います。
---

# Ph3. 技術選定フェーズ指示書

## フェーズ概要

| 項目 | 内容 |
|------|------|
| 目的 | 要件を実現するための最適な技術スタックを決定する |
| 担当 | AG |
| 成果物 | 技術選定書（tech_stack.md） |
| 前フェーズ | Ph2. 要件定義 |
| 次フェーズ | Ph4. ガイドライン生成 |

---

## ワークフロー

```
Step1: 要件からの導出
  - 機能要件・非機能要件から必要な技術カテゴリを洗い出す
  ↓
Step2: 施主の意向確認
  - 経験・学習目的・予算などをヒアリング
  ↓
Step3: 候補の提示と比較
  - 各カテゴリで候補を提示し、施主とディスカッション
  ↓
Step4: CCレビュー・施主承認
  - 技術的な妥当性を確認、施主最終承認
  ↓
完了 → Ph4へ
```

---

## Step1: 要件からの導出

要件定義書を参照し、選定が必要な技術カテゴリを洗い出す。

### 要件→技術カテゴリ マッピング表

#### 機能要件から導出

| トリガーとなる要件 | 選定が必要な技術カテゴリ | 備考 |
|-------------------|------------------------|------|
| ユーザー認証が必要 | 認証サービス | OAuth、メール/パスワード、マジックリンク等 |
| 画像/ファイルのアップロード | ストレージサービス | 容量、アクセス制御の要件も確認 |
| データの永続化が必要 | データベース | リレーショナル or NoSQL |
| 全文検索が必要 | 検索エンジン | DBの検索機能で足りるか、専用サービスが必要か |
| リアルタイム更新が必要 | リアルタイム通信 | WebSocket、Supabase Realtime等 |
| メール送信が必要 | メールサービス | トランザクションメール、マーケティングメール |
| 決済が必要 | 決済サービス | Stripe、PAY.JP等 |
| 外部サービス連携が必要 | 外部API | 具体的なサービスを特定 |
| スケジュール実行が必要 | ジョブスケジューラ | Cron、Vercel Cron等 |

#### 非機能要件から導出

| トリガーとなる要件 | 選定が必要な技術カテゴリ | 備考 |
|-------------------|------------------------|------|
| SEO対応が必要 | フレームワーク | SSR/SSG対応が必須 |
| アクセス解析を導入 | 解析ツール | GA4、Umami、Plausible等 |
| エラーログ収集を導入 | エラー監視サービス | Sentry、LogRocket等 |
| 多言語対応が必要 | i18nライブラリ | フレームワーク選定にも影響 |

#### 常に選定が必要な項目

| カテゴリ | 説明 |
|---------|------|
| フレームワーク | フロントエンドの基盤（Next.js、Nuxt、SvelteKit等） |
| スタイリング | CSS手法（Tailwind、CSS Modules等） |
| UIライブラリ | UIコンポーネント（shadcn/ui、自作等） |
| ホスティング | デプロイ先（Vercel、Cloudflare Pages等） |

### 施主への確認

洗い出した技術カテゴリを施主に提示する。

```
要件定義書を確認したところ、以下の技術カテゴリの選定が必要だよ：

【必須】
- フレームワーク
- スタイリング
- UIライブラリ
- データベース
- 認証サービス
- ホスティング

【該当する要件がある】
- ストレージサービス（画像アップロード機能）
- アクセス解析（非機能要件で「やる」）

漏れや追加はある？
```

---

## Step2: 施主の意向確認

技術選定は要件だけでなく、施主の意向も重要な判断材料になる。

### 2-1. 技術的な経験・スキル

**質問例**:
- 今まで使ったことのあるフレームワークや言語は？
- 得意な技術、苦手な技術はある？
- 「これは絶対使いたい」という技術はある？

**深掘りのヒント**:
- 経験がある技術は学習コストが下がるため、優先的に検討
- 「使ったことはないけど興味がある」も重要な情報

### 2-2. 学習目的

**質問例**:
- このプロジェクトを通じて学びたい技術はある？
- 逆に「今回は学習コストをかけたくない」という部分はある？

**深掘りのヒント**:
- 学習目的がある場合、多少効率が落ちてもその技術を選ぶ価値がある
- ただし、学習目的の技術を複数同時に入れるとプロジェクトが停滞するリスクあり

### 2-3. 予算制約

**質問例**:
- 月額費用の上限はある？
- 「完全無料で」or「少しなら払える」or「必要なら払う」どれ？

**深掘りのヒント**:
- 無料枠の範囲で収まるかは重要な選定基準
- 将来的にスケールした場合のコスト増も考慮

### 2-4. 技術トレンドへの関心

**質問例**:
- 新しい技術を積極的に試したい派？安定志向派？
- 国内で情報が多い技術を優先したい？

**深掘りのヒント**:
- 施主自身がトレンドを調べている場合、その知見を活かす
- NotebookLM等で技術トレンドを調査してもらうのも有効

### 2-5. その他の制約・希望

**質問例**:
- 「これだけは避けたい」という技術やサービスはある？
- 既に契約しているサービス（AWSアカウント等）はある？

---

## Step3: 候補の提示と比較

各技術カテゴリについて、候補を2〜3個提示し、施主とディスカッションして決定する。

### 選定観点

| 観点 | 説明 | 確認方法 |
|------|------|---------|
| コスト | 無料枠の範囲、有料時の価格 | 公式サイトのPricing |
| 学習コスト | 施主が習得するのにかかる時間・難易度 | Step2でのヒアリング結果 |
| 情報量（国内） | 日本語ドキュメント、日本語記事の充実度 | 検索、Zenn/Qiitaの記事数 |
| 技術トレンド | 国内での採用状況、今後の普及見込み | 施主の調査、検索 |
| 他サービスとの連携 | 選定済みの技術との相性 | 公式ドキュメント |
| 将来性 | メンテナンス状況、廃止リスク | GitHub、リリース履歴 |
| CCとの相性 | CCが得意な技術か（実装品質に影響） | CCへの確認 |

### 推奨する選定順序

依存関係を考慮して、以下の順序で選定する。

```
1. フレームワーク（他の選定に影響大）
2. ホスティング（フレームワークとの相性）
3. データベース
4. 認証サービス（DBとの相性）
5. ストレージ（認証・DBとの相性）
6. スタイリング
7. UIライブラリ
8. その他（解析、エラー監視等）
```

### 比較表の例

```markdown
## フレームワーク

| 観点 | Next.js | Nuxt | SvelteKit |
|------|---------|------|-----------|
| コスト | 無料 | 無料 | 無料 |
| 学習コスト | React経験あり→低 | Vue未経験→高 | 未経験→高 |
| 情報量（国内） | ◎ 非常に多い | ○ 多い | △ 少なめ |
| 技術トレンド | ◎ 主流 | ○ 安定 | △ 成長中 |
| Vercelとの相性 | ◎ 最適 | ○ 対応 | ○ 対応 |
| CCとの相性 | ◎ 得意 | ○ 対応可 | △ 情報少なめ |

**AGの推奨**: Next.js
**理由**: 施主のReact経験を活かせる、国内情報量が多い、CCのfrontend-designスキルとの相性が良い
```

### 選定時のAGの姿勢

- 一方的に決めず、施主と対話しながら決める
- 推奨は出すが、最終判断は施主に委ねる
- 「なぜそれを選ぶのか」の理由を明確にする
- トレードオフがある場合は正直に伝える

---

## Step4: CCレビュー・施主承認

### CCレビュー依頼

全カテゴリの選定が完了したら、CCにレビューを依頼する。

**レビュー依頼テンプレート**:
```
以下の技術選定をレビューしてください。

対象: docs/03_tech_stack/tech_stack.md

レビュー観点:
1. 技術的な矛盾や相性問題がないか
2. 要件に対して過不足がないか
3. 個人開発の規模に対して複雑すぎないか
4. 見落としている技術カテゴリがないか
5. より適切な代替案があれば提案

問題があれば具体的に指摘してください。
問題がなければ「問題なし」と回答してください。
```

### CCからの指摘への対応

| 指摘の種類 | 対応 |
|-----------|------|
| 技術的な矛盾 | AGが修正案を作成し、施主に確認 |
| 代替案の提案 | 施主とディスカッションして判断 |
| 見落としの指摘 | Step1に戻って追加選定 |

### 施主最終承認

CCレビューで問題がなければ（または問題を解消したら）、施主に最終確認。

### 成果物

`ph-3-tech-stack.tmp.md` を埋める。

### 完了条件

- [ ] 全ての技術カテゴリが選定されている
- [ ] 各選定に理由が記載されている
- [ ] CCレビュー完了、指摘対応済み
- [ ] **技術選定書（tech_stack.md）が作成されている**
- [ ] 施主が「技術選定完了」と承認

**次のセッションへの引き継ぎ**:
技術選定フェーズ完了時点で技術選定書を保存し、Ph4開始時に参照できるようにしておく。

---

## AGの姿勢

- **要件ドリブン**で選定する。「流行っているから」だけで選ばない
- **施主の意向**を尊重する。学習目的や好みも重要な選定理由
- **トレードオフ**を明確にする。完璧な選択肢はない
- **個人開発の前提**を忘れない。シンプルさ、保守性を重視
- **わからないことは正直に言う**。CCや施主の知見を借りる

---

## よくあるパターンと注意点

### パターン1: 「全部Supabaseでいいのでは」

Supabase（DB + 認証 + ストレージ + リアルタイム）は個人開発で人気だが、以下を確認：
- 施主がSupabaseを学ぶ意欲があるか
- 将来的に別サービスに移行する可能性はあるか（ロックイン）
- 無料枠の範囲で収まるか

### パターン2: 「施主が新技術を試したがっている」

学習目的は尊重するが、リスクも伝える：
- 新技術を複数同時に採用するとトラブル時の切り分けが難しい
- 「フレームワークは新技術、それ以外は慣れた技術」のようにバランスを取る提案

### パターン3: 「無料で全部やりたい」

無料枠の組み合わせで実現可能かを確認：
- 無料枠には制限（リクエスト数、容量、帯域等）がある
- 「最初は無料枠、スケールしたら有料プラン」という段階的アプローチを提案

### パターン4: 「よくわからないからおまかせで」

施主が判断を委ねる場合でも、理由は記録する：
- 「施主の経験を考慮して〇〇を選定」
- 「国内情報量を優先して〇〇を選定」
- 後から「なんでこれにしたんだっけ」を防ぐ