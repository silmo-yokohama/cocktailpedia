---
description: テストフェーズの指示書
---

# Ph7. テストフェーズ指示書

## フェーズ概要

| 項目 | 内容 |
|------|------|
| 目的 | 実装した機能が正しく動作するか確認する |
| 担当 | 施主（手動テスト）、CC（自動テスト）※テスト戦略による |
| 成果物 | テスト計画書、テスト結果報告 |
| 前フェーズ | Ph6. 実装 |
| 次フェーズ | Ph8. デプロイ |

**このフェーズの位置づけ**:
- Ph4で決めた「テスト戦略」に基づいて実行する
- 個人開発では手動テストがメイン
- 自動テストはテスト戦略で「積極的」「選択的」を選んだ場合のみ

---

## ワークフロー

```
Step1: テスト計画を立てる
  - テスト観点の洗い出し
  ↓
Step2: テストを実行
  - 手動テスト / 自動テスト
  ↓
Step3: バグ対応
  - 発見したバグを修正
  ↓
完了 → Ph8へ
```

---

## Step1: テスト計画を立てる

### 目的

何をどこまでテストするかを決める。

### 1-1. テスト戦略の確認

Ph4で作成したテスト戦略（`docs/04_guidelines/test_strategy.md`）を確認する。

| 基本スタンス | このフェーズでやること |
|-------------|---------------------|
| 積極的 | 自動テスト＋手動テスト |
| 選択的 | 一部自動テスト＋手動テスト |
| 最小限 | 手動テストのみ |
| なし | テストなし（Ph8へ進む） |

### 1-2. テスト観点の洗い出し

テスト計画書（`ph-7-test.tmp.md`）に、テスト観点を記載する。

**必須のテスト観点**:

| 観点 | 確認内容 |
|------|---------|
| 機能テスト | 要件定義の機能が正しく動作するか |
| 画面テスト | 画面要件どおりに表示・遷移するか |
| 入力テスト | 入力チェック、境界値が正しく動作するか |
| エラーテスト | エラー時に適切な表示がされるか |
| 認証テスト | ログイン・ログアウトが正しく動作するか（認証ありの場合） |

**選択のテスト観点**（必要に応じて）:

| 観点 | 確認内容 | 実施条件 |
|------|---------|---------|
| パフォーマンス | 許容時間内にレスポンスが返るか | 非機能要件で目標値を設定した場合 |
| セキュリティ | 基本的な脆弱性がないか | セキュリティ要件がある場合 |
| アクセシビリティ | キーボード操作、スクリーンリーダー対応 | アクセシビリティ要件がある場合 |
| 多言語 | 言語切り替えが正しく動作するか | 多言語対応の場合 |
| レスポンシブ | 各画面幅で崩れないか | モバイル対応の場合 |

### 1-3. テスト環境の準備

| 環境 | 用途 | 準備 |
|------|------|------|
| ローカル環境 | 開発中のテスト | `npm run dev` |
| プレビュー環境 | 本番に近い環境でのテスト | Vercel Preview等 |
| 本番環境 | 最終確認（デプロイ後） | デプロイ先URL |

### Step1 完了条件

- [ ] テスト観点が洗い出されている
- [ ] **テスト計画書（test_plan.md）が作成されている**
- [ ] テスト環境が準備されている

---

## Step2: テストを実行

### 手動テスト

#### 進め方

1. テスト計画書のチェックリストに沿ってテストを実行
2. 結果を記録（OK / NG / 未実施）
3. NGの場合、再現手順と期待動作を記録

#### テスト実行のコツ

- **1画面ずつ進める**: あっちこっち飛ばない
- **正常系を先に**: まず「うまくいくパターン」を確認
- **異常系は後から**: エラーパターンは正常系の後に
- **境界値を意識**: 「ちょうど0」「ちょうど上限」を確認

#### テスト記録の書き方

**OKの場合**:
```
✅ OK - 期待通りに動作
```

**NGの場合**:
```
❌ NG
再現手順:
1. ○○画面を開く
2. △△ボタンをクリック
3. □□を入力して送信

期待動作: ●●が表示される
実際の動作: ××が表示される（またはエラー）
```

### 自動テスト

※ テスト戦略で「積極的」「選択的」を選んだ場合のみ

#### CCへの指示

**テストを書かせる場合**:
```
テスト戦略（docs/04_guidelines/test_strategy.md）に基づいて、
以下の箇所にテストを追加してください。

対象:
- src/lib/utils/calculateTotal.ts（計算ロジック）
- src/lib/utils/validateEmail.ts（バリデーション）

テストツール: Vitest（or Jest）

観点:
- 正常系（期待する入力→期待する出力）
- 異常系（不正な入力→エラー or デフォルト値）
- 境界値（0、上限値、空文字等）
```

**テスト実行**:
```
作成したテストを実行し、結果を報告してください。

実行コマンド: npm run test
```

#### テスト結果の確認

CCからの報告を確認する。

```
## テスト実行結果

実行コマンド: npm run test
実行日時: YYYY/MM/DD HH:MM

結果:
- テスト数: 10
- 成功: 10
- 失敗: 0
- スキップ: 0

備考:
- 全テストがパスしました
```

---

## Step3: バグ対応

### バグ発見時のフロー

```
バグ発見
  ↓
テスト計画書に記録（再現手順、期待動作、実際の動作）
  ↓
優先度を判定
  ↓
CCに修正依頼
  ↓
修正完了 → 再テスト
  ↓
OK → 次のテストへ
NG → 再修正
```

### バグの優先度

| 優先度 | 定義 | 対応 |
|--------|------|------|
| Critical | サービスが使えない、データ破損 | 即時修正（リリースブロッカー） |
| High | 主要機能が動かない | デプロイ前に修正必須 |
| Medium | 一部機能が動かない、代替手段あり | できれば修正 |
| Low | 見た目の問題、軽微な不具合 | 余裕があれば修正 |

### CCへの修正依頼

```
## バグ修正依頼

### バグ内容
〇〇画面で△△ボタンをクリックすると□□になる

### 再現手順
1. 〇〇画面を開く
2. △△ボタンをクリック
3. □□を入力して送信

### 期待動作
●●が表示される

### 実際の動作
××が表示される

### 優先度
High（デプロイ前に修正必須）

### 補足
- スクリーンショット：（あれば添付）
- エラーログ：（あれば添付）
```

### 修正後の確認

```
修正が完了しました。
再テストをお願いします。

修正内容:
- src/components/XxxForm.tsx のバリデーション処理を修正
```

→ 施主が再テストして OK なら完了

---

## 完了条件（フェーズ全体）

以下のすべてを満たしたら、テストフェーズ完了として Ph8 へ進む。

- [ ] 手動テストが完了している（全項目OK or 許容範囲内）
- [ ] 自動テストが完了している（テスト戦略で「あり」の場合）
- [ ] Critical / High のバグがない
- [ ] **テスト結果報告が作成されている**
- [ ] 施主が「テスト完了」と承認

---

## テスト観点チェックリスト（参考）

以下はよくあるテスト観点のチェックリスト。プロジェクトに合わせてカスタマイズする。

### 機能テスト

- [ ] ユーザー登録ができる
- [ ] ログインができる
- [ ] ログアウトができる
- [ ] データの作成ができる
- [ ] データの一覧が表示される
- [ ] データの詳細が表示される
- [ ] データの編集ができる
- [ ] データの削除ができる
- [ ] 検索・フィルタが動作する

### 画面テスト

- [ ] 全画面が表示される（404にならない）
- [ ] 画面遷移が正しい
- [ ] リンクが正しいページに飛ぶ
- [ ] 戻るボタンが正しく動作する

### 入力テスト

- [ ] 必須項目が空のとき、エラーになる
- [ ] 文字数制限を超えたとき、エラーになる
- [ ] 不正な形式（メールアドレス等）のとき、エラーになる
- [ ] 数値項目に文字を入れたとき、エラーになる

### エラーテスト

- [ ] エラー時に適切なメッセージが表示される
- [ ] 存在しないページにアクセスすると404が表示される
- [ ] 権限がないページにアクセスすると適切に処理される

### 認証テスト（認証ありの場合）

- [ ] 未ログイン状態で認証必須ページにアクセスするとリダイレクトされる
- [ ] ログイン後、元のページに戻れる
- [ ] セッションタイムアウト後、適切に処理される

### レスポンシブテスト（モバイル対応の場合）

- [ ] モバイル（375px）で崩れない
- [ ] タブレット（768px）で崩れない
- [ ] PC（1280px以上）で崩れない
- [ ] ハンバーガーメニューが動作する（モバイル）

---

## 補足：個人開発でのテストの現実解

### 「完璧」を目指さない

- 全パターンを網羅するのは無理
- 「主要な導線が動く」ことを確認すれば十分
- 細かいバグはリリース後に直す覚悟も必要

### 時間がないときの優先順位

1. **まず主要導線**: ユーザーが一番使うフロー
2. **次にエッジケース**: エラー処理、境界値
3. **最後に細部**: 見た目の微調整、マイナー機能

### 「後で直す」リストを作る

テスト中に見つけた「今は直さないけど後で直したい」問題は、別途リスト化しておく。

```
## 後で直すリスト

| # | 内容 | 優先度 | 備考 |
|---|------|--------|------|
| 1 | ○○の文言がわかりにくい | Low | 時間があれば |
| 2 | △△のアニメーションがカクつく | Low | パフォーマンス改善時 |
```