# 基本設計書（basic_design.md）

## 概要

本ドキュメントは、実装の基盤となる設計情報を定義する。
CCはこのドキュメントを参照して実装を行う。

**本ドキュメントの位置づけ**:
- 後から変更するとコストが高い部分を事前に合意するためのもの
- CCの実装方法を縛るためのものではない
- 詳細な画面設計、コンポーネント分割等はCCの判断に委ねる

**要件の曖昧さ・抜け漏れが見つかった場合**:
- 設計書で補うのではなく、要件定義フェーズに差し戻す
- 要件定義書を修正・追記し、施主承認後に設計を再開する
- ただし、技術的詳細の具体化（例：ポーリング間隔、キャッシュ時間等）は設計書に記載してOK

---

## 関連ドキュメント

| ドキュメント | パス | 説明 |
|-------------|------|------|
| 要件定義書 | docs/02_requirements/ | 機能要件、画面要件、非機能要件 |
| 技術選定書 | docs/03_tech_stack/tech_stack.md | 使用技術とその選定理由 |
| コーディング規約 | docs/04_guidelines/coding_standards.md | 実装時のルール |

---

## 1. データモデル設計

### 1.1 テーブル一覧

| テーブル名 | 説明 | 主な用途 |
|-----------|------|---------|
| | | |
| | | |
| | | |

### 1.2 テーブル定義

#### （テーブル名）

| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | uuid | PK | 主キー |
| | | | |
| | | | |
| created_at | timestamp | NOT NULL, DEFAULT now() | 作成日時 |
| updated_at | timestamp | NOT NULL, DEFAULT now() | 更新日時 |

<!-- テーブルごとにコピーして追加 -->

### 1.3 リレーション

```
（テーブル間の関係を記載）

例：
users 1 --- N posts（1人のユーザーが複数の投稿を持つ）
posts 1 --- N comments（1つの投稿に複数のコメントがつく）
```

<!-- Mermaidが使える環境なら ER図で表現してもOK -->

### 1.4 設計方針・補足

| 項目 | 方針 |
|------|------|
| 削除方式 | 物理削除 / 論理削除 |
| ID生成 | UUID / 連番 / etc. |
| タイムスタンプ | 全テーブル共通で created_at, updated_at を持つ |
| 命名規則 | snake_case |

（その他の補足事項があれば記載）

---

## 2. API設計

※ API設計が不要な場合（Server Componentsで完結する、Supabaseに直接アクセスする等）、このセクションは「API設計：不要」と記載して省略可能。

### 2.1 API一覧

| メソッド | エンドポイント | 説明 | 認証 |
|---------|---------------|------|------|
| | | | |
| | | | |
| | | | |

### 2.2 API詳細

#### （メソッド） （エンドポイント）

**説明**: （このAPIが何をするか）

**リクエスト**:

| パラメータ/フィールド | 型 | 必須 | 説明 |
|---------------------|-----|------|------|
| | | | |

**レスポンス**（成功時）:

```json
{
  
}
```

**エラーレスポンス**:

```json
{
  "error": {
    "code": "ERROR_CODE",
    "message": "エラーメッセージ"
  }
}
```

<!-- APIごとにコピーして追加。シンプルなCRUDは省略してOK -->

### 2.3 共通仕様

#### 認証

（認証方式を記載）

例：
- 認証が必要なエンドポイントは、Authorizationヘッダーにトークンを含める
- 形式: `Authorization: Bearer <token>`

#### エラーレスポンス形式

```json
{
  "error": {
    "code": "ERROR_CODE",
    "message": "エラーメッセージ"
  }
}
```

| コード | HTTPステータス | 説明 |
|--------|---------------|------|
| VALIDATION_ERROR | 400 | バリデーションエラー |
| UNAUTHORIZED | 401 | 認証エラー |
| FORBIDDEN | 403 | 権限エラー |
| NOT_FOUND | 404 | リソースが見つからない |
| INTERNAL_ERROR | 500 | サーバーエラー |

---

## 3. アーキテクチャ方針

### 3.1 全体構成

```
（システム全体の構成を図示）

例：
[ブラウザ] → [Next.js (Vercel)] → [Supabase]
                                    ├── PostgreSQL（DB）
                                    ├── Auth（認証）
                                    └── Storage（ファイル）
```

### 3.2 データフロー

（主要な処理のデータの流れを記載）

#### （処理名）

```
1. 
2. 
3. 
```

<!-- 主要な処理ごとに追加 -->

### 3.3 その他の方針

（プロジェクト固有の方針があれば記載）

| 項目 | 方針 |
|------|------|
| 状態管理 | |
| キャッシュ | |
| エラーハンドリング | |

---

## 備考

- 作成日: YYYY/MM/DD
- 作成者: AG
- ステータス: ドラフト / CCレビュー済み / 施主承認済み

### 更新履歴

| 日付 | 内容 | 担当 |
|------|------|------|
| YYYY/MM/DD | 初版作成 | AG |